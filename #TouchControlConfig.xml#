<?xml version="1.0" encoding="utf-8"?>
<touchControl platform="mac"><activities><activity name="Scoreboard" location="Default iPhone" active="yes" mousekeyboard="no" index="3" deviceType="0" background="black_iPhone_full.jpg" image="touchcontrol_remote_Default iPhone^Scoreboard.jpg" scale="yes"/><activity name="Chat" location="Default iPhone" active="yes" mousekeyboard="no" index="4" background="black_iPhone_full.jpg" image="touchcontrol_remote_Default iPhone^Chat.jpg" deviceType="0" scale="yes"/><activity name="Unlock" location="Default iPad" active="no" mousekeyboard="no" index="2" background="blurred_ipad@2x.jpg" image="touchcontrol_remote_Default iPad^Unlock.jpg" deviceType="1" scale="yes"><device name="Unlock"><buttons><button name="GoFullScreen" type="cmd" top="50" left="197" textPosition="offdisabled" textSize="medium" textColor="Black" width="20" height="19" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="1" interval="0.1" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" index="0"><code>{fullscreen:on}</code></button><button name="UnlockThenBack" type="mac" top="50" left="174" textPosition="offdisabled" textSize="medium" textColor="Black" width="20" height="19" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="0" interval="0.1" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" index="1"><code>[{macrostart}{. (7)}|{UnlockScreen [Unlock]}|{Back [Unlock]}{macroend}]</code></button><button name="FadeThenClear" type="mac" top="50" left="151" textPosition="offdisabled" textSize="medium" textColor="Black" width="20" height="19" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="0" interval="0.1" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" index="2"><code>[{macrostart}{Fade [Unlock]}|{. (5)}|{Clear [Unlock]}{macroend}]</code></button><button name="PassLabel" type="label" top="113" left="391" textPosition="on" textSize="xx-large" textColor="White" width="243" height="32" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="-1" interval="" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" index="3"><code>
            </code></button><button name="LockScreen" type="cmd" top="50" left="105" textPosition="off" textSize="medium" textColor="Black" width="20" height="19" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="1" interval="0.1" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" index="4"><code>{screen lock:on}</code></button><button name="Back" type="link" top="50" left="82" textPosition="offdisabled" textSize="medium" textColor="Black" width="20" height="19" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="[go back]" repeat="1" interval="" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" index="5"><code>
            </code></button><button name="UnlockScreen" type="cmd" top="50" left="128" textPosition="offdisabled" textSize="medium" textColor="Black" width="20" height="19" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="1" interval="0.1" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" index="6"><code>{screen lock:off}</code></button><button name="OnLoad" type="script" top="50" left="59" textPosition="offdisabled" textSize="medium" textColor="Black" width="20" height="19" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="1" interval="0.1" rotation="0" autoexec="True" autoexit="False" autoresume="False" icon="" touchTip="False" index="7"><code>
            </code></button><button name="UnlockLabel" type="label" top="48" left="303" textPosition="on" textSize="x-large" textColor="White" width="419" height="40" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="-1" interval="" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" index="8"><code>Enter passcode to unlock</code></button><button name="Keypad" type="group" top="162" left="312" textPosition="off" textSize="medium" textColor="Black" width="400" height="540" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="1" interval="0" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" index="9"><code>
            </code></button><button name="1" type="script" top="20" left="20" textPosition="on" textSize="xx-large" textColor="White" width="80" height="80" delay="no" buttonPack="Unlock" buttonFile="Unlock/roundkey.png" altButtonFile="Unlock/roundkeypressed.png" linkActivity="" repeat="1" interval="0.1" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" group="Unlock^Keypad" template="0" index="10"><code>
            </code></button><button name="2" type="script" top="20" left="160" textPosition="on" textSize="xx-large" textColor="White" width="80" height="80" delay="no" buttonPack="Unlock" buttonFile="Unlock/roundkey.png" altButtonFile="Unlock/roundkeypressed.png" linkActivity="" repeat="1" interval="0.1" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" group="Unlock^Keypad" template="0" index="11"><code>
            </code></button><button name="3" type="script" top="20" left="300" textPosition="on" textSize="xx-large" textColor="White" width="80" height="80" delay="no" buttonPack="Unlock" buttonFile="Unlock/roundkey.png" altButtonFile="Unlock/roundkeypressed.png" linkActivity="" repeat="1" interval="0.1" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" group="Unlock^Keypad" template="0" index="12"><code>
            </code></button><button name="6" type="script" top="160" left="300" textPosition="on" textSize="xx-large" textColor="White" width="80" height="80" delay="no" buttonPack="Unlock" buttonFile="Unlock/roundkey.png" altButtonFile="Unlock/roundkeypressed.png" linkActivity="" repeat="1" interval="0.1" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" group="Unlock^Keypad" template="0" index="13"><code>
            </code></button><button name="5" type="script" top="160" left="160" textPosition="on" textSize="xx-large" textColor="White" width="80" height="80" delay="no" buttonPack="Unlock" buttonFile="Unlock/roundkey.png" altButtonFile="Unlock/roundkeypressed.png" linkActivity="" repeat="1" interval="0.1" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" group="Unlock^Keypad" template="0" index="14"><code>
            </code></button><button name="4" type="script" top="160" left="20" textPosition="on" textSize="xx-large" textColor="White" width="80" height="80" delay="no" buttonPack="Unlock" buttonFile="Unlock/roundkey.png" altButtonFile="Unlock/roundkeypressed.png" linkActivity="" repeat="1" interval="0.1" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" group="Unlock^Keypad" template="0" index="15"><code>
            </code></button><button name="7" type="script" top="300" left="20" textPosition="on" textSize="xx-large" textColor="White" width="80" height="80" delay="no" buttonPack="Unlock" buttonFile="Unlock/roundkey.png" altButtonFile="Unlock/roundkeypressed.png" linkActivity="" repeat="1" interval="0.1" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" group="Unlock^Keypad" template="0" index="16"><code>
            </code></button><button name="8" type="script" top="300" left="160" textPosition="on" textSize="xx-large" textColor="White" width="80" height="80" delay="no" buttonPack="Unlock" buttonFile="Unlock/roundkey.png" altButtonFile="Unlock/roundkeypressed.png" linkActivity="" repeat="1" interval="0.1" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" group="Unlock^Keypad" template="0" index="17"><code>
            </code></button><button name="9" type="script" top="300" left="300" textPosition="on" textSize="xx-large" textColor="White" width="80" height="80" delay="no" buttonPack="Unlock" buttonFile="Unlock/roundkey.png" altButtonFile="Unlock/roundkeypressed.png" linkActivity="" repeat="1" interval="0.1" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" group="Unlock^Keypad" template="0" index="18"><code>
            </code></button><button name="Delete" type="script" top="440" left="20" textPosition="on" textSize="large" textColor="White" width="80" height="80" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="1" interval="0.1" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" group="Unlock^Keypad" template="0" index="19"><code>
            </code></button><button name="0" type="script" top="440" left="160" textPosition="on" textSize="xx-large" textColor="White" width="80" height="80" delay="no" buttonPack="Unlock" buttonFile="Unlock/roundkey.png" altButtonFile="Unlock/roundkeypressed.png" linkActivity="" repeat="1" interval="0.1" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" group="Unlock^Keypad" template="0" index="20"><code>
            </code></button><button name="Clear" type="script" top="440" left="300" textPosition="on" textSize="large" textColor="White" width="80" height="80" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="1" interval="0.1" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" group="Unlock^Keypad" template="0" index="21"><code>
            </code></button><button name="PassBackdrop" type="label" top="109" left="391" textPosition="ondisabled" textSize="xx-large" textColor="White" width="243" height="40" delay="no" buttonPack="White)" buttonFile="" altButtonFile="" linkActivity="" repeat="-1" interval="" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" index="22"><code>
            </code></button></buttons></device></activity><activity name="Unlock" location="Default iPhone" active="no" mousekeyboard="no" index="5" background="blurred_iphone@2x.jpg" image="touchcontrol_remote_Default iPhone^Unlock.jpg"><device name="Unlock"><buttons><button name="GoFullScreen" type="cmd" top="506" left="219" textPosition="offdisabled" textSize="medium" textColor="Black" width="20" height="19" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="1" interval="0.1" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" index="0"><code>{fullscreen:on}</code></button><button name="UnlockThenBack" type="mac" top="506" left="196" textPosition="offdisabled" textSize="medium" textColor="Black" width="20" height="19" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="0" interval="0.1" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" index="1"><code>[{macrostart}{. (7)}|{UnlockScreen [Unlock]}|{Back [Unlock]}{macroend}]</code></button><button name="FadeThenClear" type="mac" top="506" left="173" textPosition="offdisabled" textSize="medium" textColor="Black" width="20" height="19" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="0" interval="0.1" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" index="2"><code>[{macrostart}{Fade [Unlock]}|{. (5)}|{Clear [Unlock]}{macroend}]</code></button><button name="PassLabel" type="label" top="94" left="45" textPosition="on" textSize="xx-large" textColor="White" width="230" height="32" delay="no" buttonPack="Clear" buttonFile="" altButtonFile="" linkActivity="" repeat="-1" interval="" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" index="3"><code>
            </code></button><button name="LockScreen" type="cmd" top="506" left="127" textPosition="off" textSize="medium" textColor="Black" width="20" height="19" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="1" interval="0.1" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" index="4"><code>{screen lock:on}</code></button><button name="Back" type="link" top="506" left="104" textPosition="offdisabled" textSize="medium" textColor="Black" width="20" height="19" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="[go back]" repeat="1" interval="" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" index="5"><code>
            </code></button><button name="UnlockScreen" type="cmd" top="506" left="150" textPosition="offdisabled" textSize="medium" textColor="Black" width="20" height="19" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="1" interval="0.1" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" index="6"><code>{screen lock:off}</code></button><button name="OnLoad" type="script" top="506" left="81" textPosition="offdisabled" textSize="medium" textColor="Black" width="20" height="19" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="1" interval="0.1" rotation="0" autoexec="True" autoexit="False" autoresume="False" icon="" touchTip="False" index="7"><code>
            </code></button><button name="UnlockLabel" type="label" top="38" left="3" textPosition="on" textSize="large" textColor="White" width="314" height="40" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="-1" interval="" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" index="8"><code>Enter passcode to unlock</code></button><button name="Keypad" type="group" top="152" left="32" textPosition="off" textSize="medium" textColor="Black" width="256" height="345" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="1" interval="0" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" index="9"><code>
            </code></button><button name="1" type="script" top="4" left="4" textPosition="on" textSize="xx-large" textColor="White" width="70" height="70" delay="no" buttonPack="Unlock" buttonFile="Unlock/roundkey.png" altButtonFile="Unlock/roundkeypressed.png" linkActivity="" repeat="1" interval="0.1" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" group="Unlock^Keypad" template="0" index="10"><code>
            </code></button><button name="2" type="script" top="4" left="93" textPosition="on" textSize="xx-large" textColor="White" width="70" height="70" delay="no" buttonPack="Unlock" buttonFile="Unlock/roundkey.png" altButtonFile="Unlock/roundkeypressed.png" linkActivity="" repeat="1" interval="0.1" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" group="Unlock^Keypad" template="0" index="11"><code>
            </code></button><button name="3" type="script" top="4" left="182" textPosition="on" textSize="xx-large" textColor="White" width="70" height="70" delay="no" buttonPack="Unlock" buttonFile="Unlock/roundkey.png" altButtonFile="Unlock/roundkeypressed.png" linkActivity="" repeat="1" interval="0.1" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" group="Unlock^Keypad" template="0" index="12"><code>
            </code></button><button name="6" type="script" top="93" left="182" textPosition="on" textSize="xx-large" textColor="White" width="70" height="70" delay="no" buttonPack="Unlock" buttonFile="Unlock/roundkey.png" altButtonFile="Unlock/roundkeypressed.png" linkActivity="" repeat="1" interval="0.1" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" group="Unlock^Keypad" template="0" index="13"><code>
            </code></button><button name="5" type="script" top="93" left="93" textPosition="on" textSize="xx-large" textColor="White" width="70" height="70" delay="no" buttonPack="Unlock" buttonFile="Unlock/roundkey.png" altButtonFile="Unlock/roundkeypressed.png" linkActivity="" repeat="1" interval="0.1" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" group="Unlock^Keypad" template="0" index="14"><code>
            </code></button><button name="4" type="script" top="93" left="4" textPosition="on" textSize="xx-large" textColor="White" width="70" height="70" delay="no" buttonPack="Unlock" buttonFile="Unlock/roundkey.png" altButtonFile="Unlock/roundkeypressed.png" linkActivity="" repeat="1" interval="0.1" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" group="Unlock^Keypad" template="0" index="15"><code>
            </code></button><button name="7" type="script" top="182" left="4" textPosition="on" textSize="xx-large" textColor="White" width="70" height="70" delay="no" buttonPack="Unlock" buttonFile="Unlock/roundkey.png" altButtonFile="Unlock/roundkeypressed.png" linkActivity="" repeat="1" interval="0.1" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" group="Unlock^Keypad" template="0" index="16"><code>
            </code></button><button name="8" type="script" top="182" left="93" textPosition="on" textSize="xx-large" textColor="White" width="70" height="70" delay="no" buttonPack="Unlock" buttonFile="Unlock/roundkey.png" altButtonFile="Unlock/roundkeypressed.png" linkActivity="" repeat="1" interval="0.1" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" group="Unlock^Keypad" template="0" index="17"><code>
            </code></button><button name="9" type="script" top="182" left="182" textPosition="on" textSize="xx-large" textColor="White" width="70" height="70" delay="no" buttonPack="Unlock" buttonFile="Unlock/roundkey.png" altButtonFile="Unlock/roundkeypressed.png" linkActivity="" repeat="1" interval="0.1" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" group="Unlock^Keypad" template="0" index="18"><code>
            </code></button><button name="Delete" type="script" top="271" left="4" textPosition="on" textSize="large" textColor="White" width="70" height="70" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="1" interval="0.1" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" group="Unlock^Keypad" template="0" index="19"><code>
            </code></button><button name="0" type="script" top="271" left="93" textPosition="on" textSize="xx-large" textColor="White" width="70" height="70" delay="no" buttonPack="Unlock" buttonFile="Unlock/roundkey.png" altButtonFile="Unlock/roundkeypressed.png" linkActivity="" repeat="1" interval="0.1" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" group="Unlock^Keypad" template="0" index="20"><code>
            </code></button><button name="Clear" type="script" top="271" left="183" textPosition="on" textSize="large" textColor="White" width="70" height="70" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="1" interval="0.1" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" group="Unlock^Keypad" template="0" index="21"><code>
            </code></button><button name="PassBackdrop" type="label" top="90" left="45" textPosition="ondisabled" textSize="xx-large" textColor="White" width="230" height="40" delay="no" buttonPack="White)" buttonFile="" altButtonFile="" linkActivity="" repeat="-1" interval="" rotation="0" autoexec="False" autoexit="False" autoresume="False" icon="" touchTip="False" index="22"><code>
            </code></button></buttons></device></activity><activity name="DirecTV Remote" location="Default iPhone" active="yes" mousekeyboard="no" index="0" scale="yes" background="LightBackground.png" image="touchcontrol_remote_Default iPhone^DirecTVRemote.jpg" deviceType="0"/><activity name="Watch Movie" location="Default iPad" active="yes" mousekeyboard="no" index="0" background="downloadImage-2.jpg[off]" deviceType="1"/><activity name="Startup theater" location="Default iPad" mousekeyboard="no" index="0" active="yes"/><activity name="Theater Startup" location="hometheater" active="yes" mousekeyboard="no" index="0" background="theaterbackground1-1024x768-gray.jpg[off]" scale="yes" deviceType="1"><device name="theaterroom"><buttons><button name="onload-theater" type="script" text="onload-theater" voice="" varImage="" left="861" donate="false" top="1084" width="103" height="74" textPosition="on" textSize="medium" textColor="" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="True" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="0"><code/><script>_local.tcDisconnect=myDisconnectFunction; // executes when socket connection is broken&#13;
_local.tcReconnect=myReconnectFunction; // executes when socket connection is re- established&#13;
&#13;
&#13;
function myDisconnectFunction(button, host, port) {&#13;
     _local.message = 'Problem connecting to kodi please check device';&#13;
      _setTop('_macroMessage', 100);&#13;
      _setLeft('_macroMessage', 100);&#13;
&#13;
}&#13;
&#13;
function myReconnectFunction(button, host, port) {&#13;
&#13;
}&#13;
&#13;
&#13;
_global.kodiHost='192.168.1.10';&#13;
_global.kodiPort=80;&#13;
&#13;
_global.touchcontrolServerHost='192.168.1.122';&#13;
_global.touchcontrolServerPort=8822;&#13;
&#13;
_global.serverDown = false;&#13;
&#13;
&#13;
//log("autoloaded from " + _global.touchcontrolServerHost +':' +_global.touchcontrolServerPort );&#13;
&#13;
return '[#]{&gt;}theater-status-timer';</script></button><button name="theater-status-timer" type="http#&lt;" text="theater-status-timer" voice="" varImage="" left="847" donate="false" top="799" width="148" height="55" textPosition="on" textSize="medium" textColor="" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="0" interval="3.0" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="hubitat" remotePort="GET" icon="" touchTip="False" watchHTTPDirect="False" index="4"><code>apps/api/303/devices/207?access_token=7bf9f6ec-c032-46ca-b7b0-7d663ee4452d</code><script>data = JSON.parse(_feedback);

_local.masterStatus = data.attributes[0].currentValue;
//log('got status ' + _local.masterStatus);

//if (_local.masterStatus != _local.lastStatus) {
    if (_local.masterStatus == 'on') {
         //log('status =on ' + _brightness);
        _local.lastStatus = _local.masterStatus;
      if( _brightness &lt; 1) {
        return '[#]full-brightness';
       }
    } else if (_local.masterStatus == 'off') {
        _local.lastStatus = _local.masterStatus;
    // log('status = off ' + _brightness);
      if( _brightness &gt; 0 &amp;amp;&amp;amp; _brightness &lt;= 1) {
         return '[#]dim';
      } 
       
    }

checkServiceConnection(_global.touchcontrolServerHost, _global.touchcontrolServerPort);

//}</script><prescript/><postscript/></button></buttons></device><device name="common"><buttons><button name="dim" type="cmd" text="dim" voice="" varImage="" left="902" donate="false" top="944" width="40" height="40" textPosition="on" textSize="medium" textColor="" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="1"><code>{screen full dim}</code><postscript>_local.fullBrightness = 0</postscript></button><button name="dim 70" type="cmd!" text="dim 70" voice="" varImage="" left="877" donate="false" top="1012" width="82" height="41" textPosition="on" textSize="medium" textColor="" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="2"><code>{screen set bright:70}</code></button><button name="full-brightness" type="cmd" text="full-brightness" voice="" varImage="" left="850" donate="false" top="866" width="127" height="45" textPosition="on" textSize="medium" textColor="" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="3"><code>{screen set bright:100}</code></button></buttons></device><device name="Home"><buttons><button name="_macroMessage" type="label" text="message" voice="" varImage="" left="-5" donate="false" top="799" width="838" height="669" textPosition="on" textSize="xx-large" textColor="#00FFFF" delay="no" buttonPack="theater-buttons)" buttonFile="theater-buttons/floading panel-opec-metal.png" altButtonFile="" linkActivity="" repeat="0" interval="0.0" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="5"><code>message</code><properties>DisplayFrame[~~]center,center,80%,80%</properties></button><button name="devices" type="link" text="devices" voice="" varImage="" left="830" donate="false" top="647" width="189" height="116" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/devoices.png" altButtonFile="theater-buttons/devoices-pressed.png" linkActivity="hometheater^devices" repeat="0" interval="11:0.3" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="6"><code/></button><button name="music time" type="cmd" text="music time" voice="" varImage="" left="535" donate="false" top="26" width="470" height="200" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/music-time.png" altButtonFile="theater-buttons/music-time-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="7"><code/></button><button name="watch a movie" type="mac" text="watch a movie" voice="" varImage="" left="33" donate="false" top="25" width="470" height="200" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/movie-time.png" altButtonFile="theater-buttons/movie-time-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="8"><code>[{macrostart}{setLoadingMacroMessage [Home]}|{POWER ON [theater marantz]}|{INPUT MPLAY [theater marantz]}|{! (2) X}|{Volume-to-default [theater marantz]}|{top-menu [kodi]}|{screen down [projector screen]}|{!}|{theater mode lighting- dark [theaterroom]}|{power on (globalcache) [sonyprojector]}|{! (8)}|{go to watch a movie page [Home]}|{dim 70 [common]}{macroend}]!</code><postscript>return '[#]source-kodi';</postscript></button><button name="system off" type="mac" text="system off" voice="" varImage="" left="261" donate="false" top="373" width="563" height="194" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/system-off.png" altButtonFile="theater-buttons/system-off-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="9"><code>[{macrostart}{full-brightness [common]}|{theater soffits on soft [theaterroom]}|{power off (globalcache) [sonyprojector]}|{.}|{screen up [projector screen]}|{home [kodi]}|{POWER OFF [theater marantz]}{macroend}]</code></button></buttons></device><device name="sonyprojector"><buttons/></device><device name="theater marantz"><buttons/></device></activity><activity name="Sauna Controls" location="sauna" active="yes" mousekeyboard="no" index="0" deviceType="1" scale="yes" background="[off]"><device name="Sauna hubitat page"><buttons><button name="hubitat embeded webpage" type="web" text="hubitat embeded webpage" voice="" varImage="" left="1" donate="false" top="4" width="1024" height="757" textPosition="" textSize="medium" textColor="" delay="norefresh" buttonPack="DirecTVRemote" buttonFile="DirecTVRemote/blank_white_key.png" altButtonFile="" linkActivity="" repeat="1" interval="0.0" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="0"><code>http://192.168.1.51/apps/api/405/dashboard/405?access_token=cf8984fb-ac11-4ab9-a810-d1e99f1a3f48&amp;amp;local=true</code></button></buttons></device></activity><activity name="control sauna2" location="sauna" mousekeyboard="no" index="0" background="ipad mini-wood background-768x1024.jpg[off]" active="yes" safeArea="no" scale="yes" deviceType="1"><device name="common"><buttons><button name="dim" type="cmd" text="dim" voice="" varImage="" left="7" donate="false" top="698" width="100" height="73" textPosition="on" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/square-blank.png" altButtonFile="theater-buttons/square-blank-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="buttonicons/theater 50 x 50/brightness.png" touchTip="False" watchHTTPDirect="False" index="0"><code>{screen full dim}</code><postscript>_local.fullBrightness = 0</postscript></button><button name="dim_later" type="cmd!" text="dim_later" voice="" varImage="" left="851" donate="false" top="909" width="113" height="61" textPosition="on" textSize="medium" textColor="" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="0" interval="15:15.0" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="1"><code>{screen full dim}</code></button><button name="full-brightness" type="cmd" text="full-brightness" voice="" varImage="" left="1271" donate="false" top="838" width="94" height="80" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/square-blank.png" altButtonFile="" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="buttonicons/theater 50 x 50/full-brightness.png" touchTip="False" watchHTTPDirect="False" index="11"><code>{screen set bright:100}</code></button><button name="debug" type="script" text="Logging Window" voice="" varImage="" left="801" donate="false" top="132" width="276" height="704" textPosition="on" textSize="large" textColor="Yellow" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/floading panel-opec-metal.png" altButtonFile="" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="12"><code/><script>_local.debugText = "Cleared, Logging Window";&#13;
_setText('debug', _local.debugText);</script></button></buttons></device><device name="sauna"><buttons><button name="color-rotate" type="script#" text="rotate" voice="" varImage="" left="834" donate="false" top="25" width="140" height="80" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/square-blank.png" altButtonFile="" linkActivity="" repeat="0" interval="60:60.0" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="hubitat" remotePort="GET" icon="buttonicons/theater 50 x 50/rotating-color.png" touchTip="False" watchHTTPDirect="False" index="2"><code/><script>var colorButtons = ['color-spring', 'color-orange','color-rose','color-charreuse','color-asure'];&#13;
&#13;
&#13;
if(_local.curColorIdx == undefined ) {&#13;
  _local.curColorIdx = 0;&#13;
} else {&#13;
  _local.curColorIdx += 1 % 5;&#13;
//log('here2 ' + _local.curColorIdx);&#13;
}&#13;
&#13;
//log('got color index ' + _local.curColorIdx);&#13;
return '[#]' + colorButtons[_local.curColorIdx];</script></button><button name="color-spinner-label" type="label" text="&lt;-- Lighting Colors --&gt;" voice="" varImage="" left="274" donate="false" top="313" width="227" height="40" textPosition="on" textSize="large" textColor="White" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="3"><code>Lighting Colors</code></button><button name="color-spring" type="http" text="Spring" voice="" varImage="" left="1187" donate="false" top="92" width="140" height="80" textPosition="off" textSize="medium" textColor="Cyan" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/square-blank.png" altButtonFile="" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="hubitat" remotePort="GET" icon="buttonicons/theater 50 x 50/spring-color.png" touchTip="False" watchHTTPDirect="False" index="4"><code>apps/api/303/devices/456/setColor/{"hue":42,"saturation":100,"level":100}?access_token=7bf9f6ec-c032-46ca-b7b0-7d663ee4452d</code><prescript>return '[#]{&lt;}color-rotate';</prescript></button><button name="color-rose" type="http" text="Rose" voice="" varImage="" left="1036" donate="false" top="94" width="140" height="80" textPosition="off" textSize="medium" textColor="Red" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/square-blank.png" altButtonFile="" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="hubitat" remotePort="GET" icon="buttonicons/theater 50 x 50/rose-color.png" touchTip="False" watchHTTPDirect="False" index="5"><code>apps/api/303/devices/456/setColor/{"hue":91,"saturation":100,"level":100}?access_token=7bf9f6ec-c032-46ca-b7b0-7d663ee4452d</code><prescript>return '[#]{&lt;}color-rotate';</prescript></button><button name="color-orange" type="http" text="Orange" voice="" varImage="" left="1015" donate="false" top="14" width="140" height="80" textPosition="off" textSize="medium" textColor="Orange" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/square-blank.png" altButtonFile="" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="hubitat" remotePort="GET" icon="buttonicons/theater 50 x 50/bronze-color.png" touchTip="False" watchHTTPDirect="False" index="6"><code>apps/api/303/devices/456/setColor/{"hue":10,"saturation":92,"level":26}?access_token=7bf9f6ec-c032-46ca-b7b0-7d663ee4452d</code><prescript>return '[#]{&lt;}color-rotate';</prescript></button><button name="color-charreuse" type="http" text="Charreuse" voice="" varImage="" left="1166" donate="false" top="18" width="140" height="80" textPosition="off" textSize="medium" textColor="Green" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/square-blank.png" altButtonFile="" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="hubitat" remotePort="GET" icon="buttonicons/theater 50 x 50/chareuse-color.png" touchTip="False" watchHTTPDirect="False" index="7"><code>apps/api/303/devices/456/setColor/{"hue":27,"saturation":100,"level":100}?access_token=7bf9f6ec-c032-46ca-b7b0-7d663ee4452d</code><prescript>return '[#]{&lt;}color-rotate';</prescript></button><button name="color-azure" type="http" text="Azure" voice="" varImage="" left="1323" donate="false" top="16" width="140" height="80" textPosition="off" textSize="medium" textColor="Blue" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/square-blank.png" altButtonFile="" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="hubitat" remotePort="GET" icon="buttonicons/theater 50 x 50/azure-color.png" touchTip="False" watchHTTPDirect="False" index="8"><code>apps/api/303/devices/456/setColor/{"hue":57,"saturation":100,"level":100}?access_token=7bf9f6ec-c032-46ca-b7b0-7d663ee4452d</code><prescript>return '[#]{&lt;}color-rotate';</prescript></button><button name="color-spinner" type="spin" text="color-spinner" voice="" varImage="" left="249" donate="false" top="358" width="262" height="90" textPosition="on" textSize="large" textColor="White" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="custom" repeat="1" interval="1.0" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="9"><code>sauna^color-orange|sauna^color-azure|sauna^color-spring|sauna^color-rose|sauna^color-charreuse|sauna^color-rotate|:GRID</code><properties>TextAlign[~~]center</properties></button><button name="sauna-vol-slider" type="slide" text="sauna-vol-slider" voice="" varImage="" left="221" donate="false" top="721" width="336" height="22" textPosition="on" textSize="medium" textColor="" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="multi_button" repeat="0" interval="0.0" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="True" watchHTTPDirect="False" index="10"><code>0:50:10:10:sauna^sauna-vol-req:sauna^sauna-vol-req</code><properties>sliderBarRight[~~]theaterslider-rightbar.png[~]sliderBarLeft[~~]theaterslider-leftbar.png[~]sliderThumb[~~]theaterslider-thumb.png</properties></button><button name="sauna-check-status-timer" type="http#&lt;" text="sauna-check-status-timer" voice="" varImage="" left="1022" donate="false" top="852" width="139" height="39" textPosition="on" textSize="medium" textColor="" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="0" interval="5.0" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="hubitat" remotePort="GET" icon="" touchTip="False" watchHTTPDirect="False" index="13"><code>apps/api/303/devices/588?access_token=7bf9f6ec-c032-46ca-b7b0-7d663ee4452d</code><script>[quiet]&#13;
&#13;
if(_feedback &amp;amp;&amp;amp; _feedback.startsWith('{')) {&#13;
data = JSON.parse(_feedback);&#13;
&#13;
_local.masterStatus = data.attributes[0].currentValue;&#13;
&#13;
log('feedback ' + _local.masterStatus + ', ' + _brightness);&#13;
  if (_local.masterStatus == 'on') {&#13;
    _local.lastStatus = _local.masterStatus;&#13;
    _setImage('start-sauna', 'sauna-buttons/Sauna-on-selected.png');&#13;
    if( _brightness == 0) {&#13;
        return '[#]full-brightness';&#13;
       }&#13;
  } else if (_local.masterStatus == 'off') {&#13;
      _local.lastStatus = _local.masterStatus;&#13;
      _setImage('start-sauna', 'sauna-buttons/Sauna-on.png');&#13;
  }&#13;
}</script></button><button name="onloadbutton-sauna" type="script" text="onloadbutton-sauna" voice="" varImage="" left="838" donate="false" top="850" width="161" height="43" textPosition="on" textSize="medium" textColor="" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="True" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="14"><code/><script>_enableActivitySwipe(false);&#13;
&#13;
&#13;
// trigger sauna status check on load too.&#13;
return '[#](&gt;)sauna-check-status-timer';</script></button><button name="_macroMessage" type="label" text="Please Wait Starting up..." voice="" varImage="" left="833" donate="false" top="136" width="699" height="688" textPosition="on" textSize="x-large" textColor="White" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/floading panel-opec-metal.png" altButtonFile="" linkActivity="" repeat="0" interval="0.0" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="15"><code>Please Wait Starting up...</code><properties>DisplayFrame[~~]center,center,90%,90%</properties></button><button name="sauna-off" type="mac" text="sauna-off" voice="" varImage="" left="74" donate="false" top="788" width="600" height="200" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="sauna-buttons" buttonFile="sauna-buttons/Sauna-off.png" altButtonFile="sauna-buttons/Sauna-off-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="16"><code>[{macrostart}{sauna-off-req [sauna]}|{dim_later [common]}{macroend}]</code><postscript>_setImage('start-sauna', 'sauna-buttons/Sauna-on.png');</postscript></button><button name="start-sauna" type="mac" text="start-sauna" voice="" varImage="" left="74" donate="false" top="57" width="600" height="200" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="sauna-buttons" buttonFile="sauna-buttons/Sauna-on.png" altButtonFile="sauna-buttons/Sauna-on-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="17"><code>[{macrostart}{full-brightness [common]}|{start-sauna-req [sauna]}|{! (5)}{macroend}]!</code></button><button name="sound off" type="http" text="sound off" voice="" varImage="" left="440" donate="false" top="608" width="116" height="86" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="sauna-buttons" buttonFile="sauna-buttons/sound-off.png" altButtonFile="sauna-buttons/sound-off-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="luffy" remotePort="GET" icon="" touchTip="False" watchHTTPDirect="False" index="18"><code>eventghost.html?sauna_music=off</code></button><button name="sound on" type="http" text="sound on" voice="" varImage="" left="224" donate="false" top="608" width="115" height="86" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="sauna-buttons" buttonFile="sauna-buttons/sound-on.png" altButtonFile="sauna-buttons/sound-on-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="luffy" remotePort="GET" icon="" touchTip="False" watchHTTPDirect="False" index="19"><code>eventghost.html?sauna_music=on</code></button><button name="color spinner panel" type="label" text="Lighting Colors" voice="" varImage="" left="221" donate="false" top="299" width="336" height="189" textPosition="off" textSize="large" textColor="White" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/floading panel-metal.png" altButtonFile="" linkActivity="" repeat="0" interval="0.0" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="20"><code>Lighting Colors</code><properties>TextAlign[~~]top</properties></button></buttons></device></activity><activity name="devices" location="hometheater" active="yes" mousekeyboard="no" index="0" deviceType="1" background="blackpattern-background-1024x768.jpg[off]" scale="yes"><device name="theater marantz"><buttons><button name="volume-slider" type="slide" text="volume-slider" voice="" varImage="" left="63" donate="false" top="37" width="529" height="22" textPosition="on" textSize="medium" textColor="" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="multi_button" repeat="0" interval="0.0" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="True" watchHTTPDirect="False" group="projector screen^slider panel" index="0"><code>42:62:1:57:theater marantz^volumeset:theater marantz^volumeset</code><properties>sliderBarLeft[~~]theaterslider-leftbar.png[~]sliderBarRight[~~]theaterslider-rightbar.png[~]sliderThumb[~~]theaterslider-thumb.png</properties><postscript/></button></buttons></device><device name="projector screen"><buttons><button name="screen controls label" type="label" text="Projector" voice="" varImage="" left="380" donate="false" top="132" width="245" height="97" textPosition="on" textSize="xx-large" textColor="LightGray" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="0" interval="0.0" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="2"><code>Screen Controls</code></button><button name="screen relay2 on" type="gc&lt;" text="R2" voice="" varImage="" left="428" donate="false" top="496" width="57" height="52" textPosition="on" textSize="medium" textColor="Green" delay="no" buttonPack="brushed-blank-buttons" buttonFile="brushed-blank-buttons/round-blank-medium-default.png" altButtonFile="brushed-blank-buttons/round-blank-medium-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="globalcache" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="5"><code>setstate,3:2,1</code></button><button name="screen relay1 on" type="gc&lt;" text="R1" voice="" varImage="" left="334" donate="false" top="493" width="61" height="54" textPosition="on" textSize="medium" textColor="Green" delay="no" buttonPack="brushed-blank-buttons" buttonFile="brushed-blank-buttons/round-blank-medium-default.png" altButtonFile="brushed-blank-buttons/round-blank-medium-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="globalcache" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="6"><code>setstate,3:1,1</code></button><button name="screen relay2 off" type="gc&lt;" text="R2" voice="" varImage="" left="422" donate="false" top="401" width="61" height="59" textPosition="on" textSize="medium" textColor="Red" delay="no" buttonPack="brushed-blank-buttons" buttonFile="brushed-blank-buttons/round-blank-medium-default.png" altButtonFile="brushed-blank-buttons/round-blank-medium-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="globalcache" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="7"><code>setstate,3:2,0</code></button><button name="screen relay1 off" type="gc&lt;" text="R1" voice="" varImage="" left="335" donate="false" top="400" width="60" height="58" textPosition="on" textSize="medium" textColor="Red" delay="no" buttonPack="brushed-blank-buttons" buttonFile="brushed-blank-buttons/round-blank-medium-default.png" altButtonFile="brushed-blank-buttons/round-blank-medium-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="globalcache" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="8"><code>setstate,3:1,0</code></button><button name="screen controls label" type="label" text="Projector" voice="" varImage="" left="79" donate="false" top="135" width="245" height="97" textPosition="on" textSize="xx-large" textColor="LightGray" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="0" interval="0.0" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="10"><code>Screen Controls</code></button><button name="screen up" type="mac" text="" voice="" varImage="" left="79" donate="false" top="263" width="240" height="200" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/paddle-up.png" altButtonFile="theater-buttons/paddle-up-pressed.png" linkActivity="" repeat="0" interval="0.10" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="11"><code>[{macrostart}{screen relay1 off [projector screen]}|{.}|{screen relay2 off [projector screen]}|{!}|{screen relay1 on [projector screen]}{macroend}]</code></button><button name="screen down" type="mac" text="screen down" voice="" varImage="" left="77" donate="false" top="494" width="240" height="200" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/paddle-down.png" altButtonFile="theater-buttons/paddle-down-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="12"><code>[{macrostart}{screen relay1 off [projector screen]}|{.}|{screen relay2 off [projector screen]}|{!}|{screen relay2 on [projector screen]}{macroend}]</code></button></buttons></device><device name="projector"><buttons><button name="power off" type="gc" text="Off" voice="" varImage="" left="529" donate="false" top="257" width="78" height="64" textPosition="on" textSize="large" textColor="Red" delay="no" buttonPack="brushed-blank-buttons" buttonFile="brushed-blank-buttons/round-blank-medium-default.png" altButtonFile="brushed-blank-buttons/round-blank-medium-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="globalcache-serial1" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="3"><code>\x02POF\x03\x0D\//</code></button><button name="power on" type="gc" text="On" voice="" varImage="" left="397" donate="false" top="259" width="78" height="64" textPosition="on" textSize="large" textColor="Green" delay="no" buttonPack="brushed-blank-buttons" buttonFile="brushed-blank-buttons/round-blank-medium-default.png" altButtonFile="brushed-blank-buttons/round-blank-medium-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="globalcache-serial1" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="4"><code>\x02PON\x03\x0D\//</code></button></buttons></device><device name="common"><buttons><button name="home" type="link" text="home" voice="" varImage="" left="829" donate="false" top="17" width="268" height="210" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/home-button.png" altButtonFile="theater-buttons/home-button-pressed.png" linkActivity="hometheater^Theater Startup" repeat="0" interval="12:0.3" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="9"><code/></button></buttons></device></activity><activity name="firetv-controls" location="hometheater" mousekeyboard="no" index="0" background="leather-angle2-background-1024x768.jpg[off]" deviceType="1" scale="no" active="yes"><device name="theater marantz"><buttons><button name="volume-slider" type="slide" text="volume-slider" voice="" varImage="" left="49" donate="false" top="64" width="508" height="22" textPosition="on" textSize="medium" textColor="" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="multi_button" repeat="0" interval="0.0" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" group="common^slider panel" index="0"><code>42:62:1:57:theater marantz^volumeset:theater marantz^volumeset</code><properties>sliderThumb[~~]theaterslider-thumb.png[~]sliderBarLeft[~~]theaterslider-leftbar.png[~]sliderBarRight[~~]theaterslider-rightbar.png</properties></button><button name="INPUT-firetv" type="mac" text="INPUT-firetv" voice="" varImage="" left="226" donate="false" top="778" width="121" height="22" textPosition="on" textSize="medium" textColor="" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="marantz-theater" remotePort="POST" icon="" touchTip="False" watchHTTPDirect="False" index="4"><code>[{macrostart}{turn_on [firetv]}|{INPUT CBL/SAT [theater marantz]}{macroend}]</code></button></buttons></device><device name="common"><buttons><button name="slider panel" type="group" text="slider panel" voice="" varImage="" left="212" donate="false" top="647" width="622" height="138" textPosition="off" textSize="medium" textColor="" delay="no" template="volume slider group!" buttonPack="theater-buttons)" buttonFile="theater-buttons/horizontal-panel-bottom.png" altButtonFile="" linkActivity="" repeat="0" interval="0.0" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="1"><code/></button><button name="source-firetv" type="mac" text="source-firetv" voice="" varImage="" left="-5" donate="false" top="144" width="160" height="115" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/sources-blank.png" altButtonFile="theater-buttons/sources-blank-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="marantz-theater" remotePort="GET" icon="buttonicons/theater 100 x 100/source-firetv-icon.png" touchTip="False" watchHTTPDirect="False" group="common^source panel" index="2"><code>[{macrostart}{INPUT AUX1 [theater marantz]}|{link to firetv controls [common]}{macroend}]</code><prescript>;</prescript><postscript>;</postscript></button><button name="source-kodi" type="mac" text="source-kodi" voice="" varImage="" left="-8" donate="false" top="15" width="160" height="115" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/sources-blank.png" altButtonFile="theater-buttons/sources-blank-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="marantz-theater" remotePort="GET" icon="buttonicons/theater 100 x 100/source-kodi-icon.png" touchTip="False" watchHTTPDirect="False" group="common^source panel" index="3"><code>[{macrostart}{INPUT MPLAY [theater marantz]}|{link to kodi controls [common]}{macroend}]</code><prescript>;</prescript></button><button name="navigation panel" type="group" text="navigation panel" voice="" varImage="" left="391" donate="false" top="165" width="309" height="323" textPosition="off" textSize="medium" textColor="" delay="no" template="" buttonPack="theater-buttons)" buttonFile="theater-buttons/floading panel-metal.png" altButtonFile="" linkActivity="" repeat="0" interval="0.0" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="16"><code/></button><button name="home" type="link" text="home" voice="" varImage="" left="827" donate="false" top="4" width="180" height="146" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/square-blank.png" altButtonFile="theater-buttons/square-blank-led-pressed.png" linkActivity="hometheater^Theater Startup" repeat="0" interval="12:0.3" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="buttonicons/theater 100 x 100/home-icon.png" touchTip="False" watchHTTPDirect="False" index="18"><code/></button><button name="onloadbutton-firetv-controls" type="script" text="onloadbutton-firetv-controls" voice="" varImage="" left="9" donate="false" top="768" width="200" height="39" textPosition="on" textSize="medium" textColor="" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="True" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="19"><code/><script>_enableActivitySwipe(false);&#13;
&#13;
currentSource = _activity.split('-')[0];&#13;
// debugText = "Current activity name " + _activity +"\n";&#13;
&#13;
if (_global.activeSource != currentSource) {&#13;
  _global.activeSource = currentSource;&#13;
&#13;
  debugText =  _global.activeSource +"\n";&#13;
&#13;
  _setImage('source-kodi','theater-buttons/sources-blank.png');&#13;
  _setImage('source-firetv','theater-buttons/sources-blank.png');&#13;
&#13;
  _setImage('source-' + currentSource ,'theater-buttons/sources-blank-selected.png');&#13;
  debugText =  "Setting selected on " + 'source-' + _global.activeSource  +"; \n";&#13;
&#13;
}&#13;
&#13;
// trigger subtitle check on load too.&#13;
// trigger any other timers etc here&#13;
//return '[#]subtitle-check-timer';&#13;
return '[#]INPUT-' + currentSource;</script></button><button name="source panel" type="group" text="source panel" voice="" varImage="" left="2" donate="false" top="86" width="168" height="418" textPosition="off" textSize="medium" textColor="" delay="no" template="source panel template2!" buttonPack="TransDark)" buttonFile="" altButtonFile="" linkActivity="" repeat="0" interval="0.0" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="20"><code/><properties>CornerRadius[~~]15</properties></button></buttons></device><device name="firetv"><buttons><button name="previous" type="http" text="previous" voice="" varImage="" left="386" donate="false" top="513" width="92" height="85" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/round-blank.png" altButtonFile="theater-buttons/round-blank-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="firetv-server" remotePort="GET" icon="buttonicons/theater 50 x 50/skip-to-start.png" touchTip="False" watchHTTPDirect="False" index="5"><code>devices/action/theater/media_previous</code></button><button name="next" type="http" text="next" voice="" varImage="" left="618" donate="false" top="517" width="92" height="85" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/round-blank.png" altButtonFile="theater-buttons/round-blank-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="firetv-server" remotePort="GET" icon="buttonicons/theater 50 x 50/skip-to-end.png" touchTip="False" watchHTTPDirect="False" index="6"><code>devices/action/theater/media_next</code></button><button name="play" type="http" text="play" voice="" varImage="" left="501" donate="false" top="516" width="92" height="85" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/round-blank.png" altButtonFile="theater-buttons/round-blank-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="firetv-server" remotePort="GET" icon="buttonicons/theater 50 x 50/play.png" touchTip="False" watchHTTPDirect="False" index="7"><code>devices/action/theater/media_play</code></button><button name="menu" type="http" text="menu" voice="" varImage="" left="729" donate="false" top="272" width="84" height="80" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/round-blank.png" altButtonFile="theater-buttons/round-blank-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="firetv-server" remotePort="GET" icon="buttonicons/Black 20x20/hamburger.png" touchTip="False" watchHTTPDirect="False" index="8"><code>devices/action/theater/menu</code></button><button name="back" type="http" text="back" voice="" varImage="" left="240" donate="false" top="172" width="93" height="90" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/round-blank.png" altButtonFile="theater-buttons/round-blank-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="firetv-server" remotePort="GET" icon="buttonicons/Black 20x20/back.png" touchTip="False" watchHTTPDirect="False" index="9"><code>devices/action/theater/back</code></button><button name="home" type="http" text="home" voice="" varImage="" left="726" donate="false" top="164" width="87" height="87" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/round-blank.png" altButtonFile="theater-buttons/round-blank-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="firetv-server" remotePort="GET" icon="buttonicons/Black 20x20/home.png" touchTip="False" watchHTTPDirect="False" index="10"><code>devices/action/theater/home</code></button><button name="nav center" type="http" text="nav center" voice="" varImage="" left="109" donate="false" top="111" width="80" height="80" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/round-blank.png" altButtonFile="theater-buttons/round-blank-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="firetv-server" remotePort="GET" icon="buttonicons/theater 50 x 50/select.png" touchTip="False" watchHTTPDirect="False" group="common^navigation panel" index="11"><code>devices/action/theater/enter</code></button><button name="nav down" type="http" text="nav down" voice="" varImage="" left="86" donate="false" top="194" width="116" height="99" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/paddle-down.png" altButtonFile="theater-buttons/paddle-down-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="firetv-server" remotePort="GET" icon="" touchTip="False" watchHTTPDirect="False" group="common^navigation panel" index="12"><code>devices/action/theater/down</code></button><button name="nav left" type="http" text="nav left" voice="" varImage="" left="-1" donate="false" top="97" width="116" height="99" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/paddle-left.png" altButtonFile="theater-buttons/paddle-left-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="firetv-server" remotePort="GET" icon="" touchTip="False" watchHTTPDirect="False" group="common^navigation panel" index="13"><code>devices/action/theater/left</code></button><button name="nav right" type="http" text="nav right" voice="" varImage="" left="178" donate="false" top="99" width="116" height="98" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/paddle-right.png" altButtonFile="theater-buttons/paddle-right-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="firetv-server" remotePort="GET" icon="" touchTip="False" watchHTTPDirect="False" group="common^navigation panel" index="14"><code>devices/action/theater/right</code></button><button name="nav up" type="http" text="nav up" voice="" varImage="" left="89" donate="false" top="6" width="116" height="99" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/paddle-up.png" altButtonFile="theater-buttons/paddle-up-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="firetv-server" remotePort="GET" icon="" touchTip="False" watchHTTPDirect="False" group="common^navigation panel" index="15"><code>devices/action/theater/up</code></button></buttons></device><device name="kodi"><buttons><button name="top button panel" type="group" text="top button panel" voice="" varImage="" left="175" donate="false" top="-29" width="642" height="180" textPosition="off" textSize="medium" textColor="" delay="no" template="" buttonPack="theater-buttons" buttonFile="theater-buttons/horizontal-panel.png" altButtonFile="" linkActivity="" repeat="0" interval="0.0" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="17"><code/></button></buttons></device><device name="projector screen"><buttons/></device></activity><activity name="kodi-controls-secondary" location="hometheater" active="yes" mousekeyboard="no" index="0" background="leather-angle2-background-1024x768.jpg[off]" deviceType="1" scale="no"><device name="kodi"><buttons><button name="top-menu" type="http" text="" voice="" varImage="" left="168" donate="false" top="189" width="151" height="139" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/square-blank.png" altButtonFile="theater-buttons/square-blank-led-pressed.png" linkActivity="" repeat="0" interval="0.10" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="kodi-proxy" remotePort="POST" icon="buttonicons/theater 100 x 100/topmenu-icon.png" touchTip="False" watchHTTPDirect="False" index="0"><code>jsonrpc[?]{"jsonrpc":"2.0","method":"Input.Home","id":1}</code><script/><prescript/><postscript/></button><button name="context-menu" type="et" text="context-menu" voice="" varImage="" left="341" donate="false" top="187" width="152" height="139" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/square-blank.png" altButtonFile="theater-buttons/square-blank-led-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="GET" icon="buttonicons/theater 100 x 100/menu-icon.png" touchTip="False" watchHTTPDirect="False" index="1"><code/></button><button name="Watched toggle" type="http" text="Watched toggle" voice="" varImage="" left="173" donate="false" top="360" width="151" height="139" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/square-blank.png" altButtonFile="theater-buttons/square-blank-led-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="kodi-proxy" remotePort="POST" icon="buttonicons/theater 100 x 100/watch-icon.png" touchTip="False" watchHTTPDirect="False" index="2"><code>jsonrpc[?]{"jsonrpc":"2.0","method":"Input.ExecuteAction","params":{"action":"togglewatched"},"id":1}</code></button><button name="update-library" type="http" text="" voice="" varImage="" left="335" donate="false" top="362" width="152" height="139" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/square-blank.png" altButtonFile="theater-buttons/square-blank-led-pressed.png" linkActivity="" repeat="0" interval="0.10" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="kodi-proxy" remotePort="POST" icon="buttonicons/theater 100 x 100/update-icon.png" touchTip="False" watchHTTPDirect="False" index="3"><code>jsonrpc[?]{"jsonrpc":"2.0","method"."VideoLibrary.Scan","params":{"showdialogs":true},"id":1}</code><script/><prescript/><postscript/></button><button name="back" type="link" text="back" voice="" varImage="" left="-235" donate="false" top="-21" width="1573" height="143" textPosition="off" textSize="medium" textColor="White" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/square-blank.png" altButtonFile="theater-buttons/square-blank-pressed.png" linkActivity="[go back]" repeat="0" interval="0.0" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="kodi-proxy" remotePort="POST" icon="buttonicons/theater 100 x 100/level-up.png" touchTip="False" watchHTTPDirect="False" index="4"><code/></button></buttons></device><device name="common"><buttons/></device><device name="projector screen"><buttons/></device><device name="theater marantz"><buttons/></device></activity><activity name="kodi-controls" location="hometheater" active="yes" mousekeyboard="no" index="0" background="leather-angle2-background-1024x768.jpg[off]" deviceType="1" scale="no"><device name="theater marantz"><buttons><button name="volume-slider" type="slide" text="volume-slider" voice="" varImage="" left="49" donate="false" top="64" width="508" height="22" textPosition="on" textSize="medium" textColor="" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="multi_button" repeat="0" interval="0.0" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" group="common^slider panel" index="0"><code>42:62:1:57:theater marantz^volumeset:theater marantz^volumeset</code><properties>sliderBarRight[~~]theaterslider-rightbar.png[~]sliderThumb[~~]theaterslider-thumb.png[~]sliderBarLeft[~~]theaterslider-leftbar.png</properties></button><button name="INPUT-kodi" type="http" text="INPUT-kodi" voice="" varImage="" left="42" donate="false" top="860" width="111" height="40" textPosition="on" textSize="medium" textColor="" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="marantz-theater" remotePort="POST" icon="" touchTip="False" watchHTTPDirect="False" index="2"><code>MainZone/index.put.asp[?]cmd0=PutZone_InputFunction%2FMPLAY&amp;amp;cmd1=aspMainZone_WebUpdateStatus%2F</code></button><button name="volume-check" type="http#&lt;" text="volume-check" voice="" varImage="" left="808" donate="false" top="794" width="108" height="48" textPosition="on" textSize="medium" textColor="Black" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="0" interval="1.15" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="marantz-theater" remotePort="GET" icon="" touchTip="False" watchHTTPDirect="False" index="4"><code>goform/formMainZone_MainZoneXml.xml</code><script>[quiet]&#13;
str = _feedback;&#13;
if (str &amp;amp;&amp;amp; str.startsWith('&lt;?xml')) {&#13;
startStr ='&lt;MasterVolume&gt;&lt;value&gt;';&#13;
start = str.indexOf(startStr);&#13;
end = str.indexOf('&lt;/value&gt;&lt;/MasterVolume&gt;', start);&#13;
&#13;
vol = str.substring(start + startStr.length, end);&#13;
vol  = convertToRange(vol,[-30,-10],[42,62]);&#13;
_setSelectedIndex('volume-slider', vol);&#13;
//log('got volume: ' + vol);&#13;
}</script></button><button name="volume-slider" type="slide" text="volume-slider" voice="" varImage="" left="40" donate="false" top="66" width="520" height="22" textPosition="on" textSize="medium" textColor="" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="multi_button" repeat="0" interval="0.0" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="True" watchHTTPDirect="False" group="projector screen^slider panel" index="22"><code>42:62:1:57:theater marantz^volumeset:theater marantz^volumeset</code><properties>sliderThumb[~~]theaterslider-thumb.png[~]sliderBarLeft[~~]theaterslider-leftbar.png[~]sliderBarRight[~~]theaterslider-rightbar.png</properties></button></buttons></device><device name="common"><buttons><button name="slider panel" type="group" text="slider panel" voice="" varImage="" left="212" donate="false" top="647" width="622" height="138" textPosition="off" textSize="medium" textColor="" delay="no" template="volume slider group!" buttonPack="theater-buttons)" buttonFile="theater-buttons/horizontal-panel-bottom.png" altButtonFile="" linkActivity="" repeat="0" interval="0.0" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="1"><code/></button><button name="dim" type="cmd" text="dim" voice="" varImage="" left="885" donate="false" top="591" width="98" height="80" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/square-blank.png" altButtonFile="" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="buttonicons/theater 50 x 50/brightness.png" touchTip="False" watchHTTPDirect="False" index="3"><code>{screen full dim}</code><postscript>_local.fullBrightness = 0</postscript></button><button name="debug" type="script" text="Logging Window" voice="" varImage="" left="1059" donate="false" top="-2" width="276" height="704" textPosition="on" textSize="large" textColor="Yellow" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/floading panel-opec-metal.png" altButtonFile="" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="20"><code/><script>_local.debugText = "Cleared, Logging Window";&#13;
_setText('debug', _local.debugText);</script></button><button name="onloadbutton-kodi-controls" type="script" text="onloadbutton-kodi-controls" voice="" varImage="" left="24" donate="false" top="771" width="108" height="40" textPosition="on" textSize="medium" textColor="" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="True" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="23"><code/><script>_enableActivitySwipe(false);&#13;
&#13;
_local.tcDisconnect=myDisconnectFunction; // executes when socket connection is broken&#13;
_local.tcReconnect=myReconnectFunction; // executes when socket connection is re- established&#13;
&#13;
currentSource = _activity.split('-')[0];&#13;
&#13;
if (_global.activeSource != currentSource) {&#13;
  _global.activeSource = currentSource;&#13;
&#13;
&#13;
  _setImage('source-kodi','theater-buttons/sources-blank.png');&#13;
  _setImage('source-firetv','theater-buttons/sources-blank.png');&#13;
&#13;
  _setImage('source-' + currentSource ,'theater-buttons/sources-blank-selected.png');&#13;
}&#13;
&#13;
&#13;
//return '[#]check-timer';&#13;
return '[#]INPUT-' + currentSource +'[#]{&gt;}subtitle-check[#]{&gt;}currently-playing-check[#]{&gt;}player-speed-check[#]{&gt;}volume-check';&#13;
&#13;
&#13;
&#13;
&#13;
function myDisconnectFunction(button, host, port) {&#13;
     _local.message = 'Problem connecting to kodi please check device';&#13;
      _setTop('_macroMessage', 100);&#13;
      _setLeft('_macroMessage', 100);&#13;
&#13;
}&#13;
&#13;
function myReconnectFunction(button, host, port) {&#13;
&#13;
}</script></button><button name="nav left" type="http+" text="nav left" voice="" varImage="" left="2" donate="false" top="97" width="116" height="99" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/paddle-left.png" altButtonFile="theater-buttons/paddle-left-pressed.png" linkActivity="" repeat="0" interval="0.05" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="kodi-proxy" remotePort="POST" icon="" touchTip="False" watchHTTPDirect="False" group="common^navigation panel" index="24"><code>jsonrpc[?]{"jsonrpc":"2.0","method":"Input.Left","id":1}</code></button><button name="nav up" type="http+" text="nav up" voice="" varImage="" left="87" donate="false" top="18" width="116" height="99" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/paddle-up.png" altButtonFile="theater-buttons/paddle-up-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="kodi-proxy" remotePort="POST" icon="" touchTip="False" watchHTTPDirect="False" group="common^navigation panel" index="25"><code>jsonrpc2[?]{"jsonrpc":"2.0","method":"Input.Up","id":1}</code></button><button name="nav right" type="http+" text="nav right" voice="" varImage="" left="168" donate="false" top="100" width="116" height="98" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/paddle-right.png" altButtonFile="theater-buttons/paddle-right-pressed.png" linkActivity="" repeat="0" interval="0.05" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="kodi-proxy" remotePort="POST" icon="" touchTip="False" watchHTTPDirect="False" group="common^navigation panel" index="26"><code>jsonrpc[?]{"jsonrpc":"2.0","method":"Input.Right","id":1}</code></button><button name="nav down" type="http+" text="nav down" voice="" varImage="" left="83" donate="false" top="183" width="116" height="99" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/paddle-down.png" altButtonFile="theater-buttons/paddle-down-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="kodi-proxy" remotePort="POST" icon="" touchTip="False" watchHTTPDirect="False" group="common^navigation panel" index="27"><code>jsonrpc[?]{"jsonrpc":"2.0","method":"Input.Down","id":1}</code></button><button name="nav select" type="http" text="nav select" voice="" varImage="" left="103" donate="false" top="110" width="80" height="80" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/round-blank.png" altButtonFile="theater-buttons/round-blank-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="kodi-proxy" remotePort="POST" icon="buttonicons/theater 50 x 50/select.png" touchTip="False" watchHTTPDirect="False" group="common^navigation panel" index="28"><code>jsonrpc[?]{"jsonrpc":"2.0","method":"Input.Select","id":1}</code></button><button name="navigation panel" type="group" text="navigation panel" voice="" varImage="" left="439" donate="false" top="123" width="309" height="323" textPosition="off" textSize="medium" textColor="" delay="no" template="" buttonPack="theater-buttons)" buttonFile="theater-buttons/floading panel-metal.png" altButtonFile="" linkActivity="" repeat="0" interval="0.0" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="29"><code/></button><button name="source-kodi" type="mac" text="source-kodi" voice="" varImage="" left="7" donate="false" top="29" width="160" height="115" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/sources-blank.png" altButtonFile="theater-buttons/sources-blank-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="marantz-theater" remotePort="GET" icon="buttonicons/theater 100 x 100/source-kodi-icon.png" touchTip="False" watchHTTPDirect="False" group="common^source panel" index="30"><code>[{macrostart}{INPUT MPLAY [theater marantz]}|{link to kodi controls [common]}{macroend}]</code><prescript>;</prescript></button><button name="source-firetv" type="mac" text="source-firetv" voice="" varImage="" left="6" donate="false" top="151" width="160" height="115" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/sources-blank.png" altButtonFile="theater-buttons/sources-blank-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="marantz-theater" remotePort="GET" icon="buttonicons/theater 100 x 100/source-firetv-icon.png" touchTip="False" watchHTTPDirect="False" group="common^source panel" index="31"><code>[{macrostart}{turn_on [firetv]}|{INPUT AUX1 [theater marantz]}|{link to firetv controls [common]}{macroend}]</code><prescript>;</prescript><postscript>;</postscript></button><button name="source panel" type="group" text="source panel" voice="" varImage="" left="-15" donate="false" top="62" width="219" height="448" textPosition="off" textSize="medium" textColor="" delay="no" template="source panel template2" buttonPack="theater-buttons)" buttonFile="theater-buttons/vertical panel-leather.png" altButtonFile="" linkActivity="" repeat="0" interval="0.0" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="32"><code/><properties>CornerRadius[~~]15</properties></button><button name="home" type="link" text="home" voice="" varImage="" left="820" donate="false" top="4" width="180" height="146" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/square-blank.png" altButtonFile="theater-buttons/square-blank-led-pressed.png" linkActivity="hometheater^Theater Startup" repeat="0" interval="12:0.3" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="buttonicons/theater 100 x 100/home-icon.png" touchTip="False" watchHTTPDirect="False" index="40"><code/></button></buttons></device><device name="kodi"><buttons><button name="_macroMessage" type="label" text="%message%" voice="" varImage="" left="1092" donate="false" top="532" width="991" height="745" textPosition="on" textSize="large" textColor="#65F4FF" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/floading panel-opec-metal.png" altButtonFile="" linkActivity="" repeat="0" interval="0.0" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="5"><code>%message%</code><properties>DisplayFrame[~~]center,center,80%,80%</properties></button><button name="total-time" type="label" text="total-time" voice="" varImage="" left="24" donate="false" top="42" width="455" height="40" textPosition="on" textSize="medium" textColor="LightGray" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="0" interval="0.0" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" group="kodi^time info panel" index="6"><code/></button><button name="progress-bar" type="web" text="progress-bar" voice="" varImage="" left="54" donate="false" top="85" width="399" height="38" textPosition="on" textSize="medium" textColor="" delay="" buttonPack="Clear)" buttonFile="" altButtonFile="" linkActivity="interactive;background" repeat="0" interval="0.0" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" group="kodi^time info panel" index="7"><code>&lt;style&gt;&#13;
#progressbar {&#13;
  background-color: gray;&#13;
  border-radius: 13px;&#13;
  /* (height of inner div) / 2 + padding */&#13;
  padding: 3px;&#13;
}&#13;
&#13;
#progressbar&gt;div {&#13;
  background-color: blue;&#13;
  width: 40%;&#13;
  /* Adjust with JavaScript */&#13;
  height: 20px;&#13;
  border-radius: 10px;&#13;
}&#13;
&lt;/style&gt;&#13;
&lt;body&gt;&#13;
&lt;div id="progressbar"&gt;&#13;
  &lt;div&gt;&lt;/div&gt;&#13;
&lt;/div&gt;&#13;
&lt;/body&gt;</code></button><button name="End Time" type="label" text="Movie Ends at: %endTime%" voice="" varImage="" left="489" donate="false" top="85" width="100" height="39" textPosition="on" textSize="medium" textColor="LightGray" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" group="kodi^time info panel" index="8"><code>Movie Ends at: %endTime%</code><script>_local.player.currenty&#13;
&#13;
var date1 = new Date("08/05/2015 23:41:20");&#13;
var date2 = new Date("08/06/2015 02:56:32");&#13;
&#13;
var diff = date2.getTime() - date1.getTime();&#13;
&#13;
var msec = diff;&#13;
var hh = Math.floor(msec / 1000 / 60 / 60);&#13;
msec -= hh * 1000 * 60 * 60;&#13;
var mm = Math.floor(msec / 1000 / 60);&#13;
msec -= mm * 1000 * 60;&#13;
var ss = Math.floor(msec / 1000);&#13;
msec -= ss * 1000;&#13;
&#13;
alert(hh + ":" + mm + ":" + ss);</script></button><button name="current-time" type="label" text="Total Time: %playerTotalTime% (Elapsed: %playerTime%, Time Left: %timeLeft%)" voice="" varImage="" left="482" donate="false" top="41" width="113" height="39" textPosition="on" textSize="medium" textColor="LightGray" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="0" interval="0.0" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" group="kodi^time info panel" index="9"><code>Total Time: %playerTotalTime% (Elapsed: %playerTime%, Time Left: %timeLeft%)</code></button><button name="time info panel" type="group" text="time info panel" voice="" varImage="" left="194" donate="false" top="-31" width="611" height="156" textPosition="on" textSize="medium" textColor="" delay="no" template="" buttonPack="theater-buttons" buttonFile="theater-buttons/horizontal-panel.png" altButtonFile="" linkActivity="" repeat="0" interval="0.0" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="10"><code/></button><button name="more-controls-link" type="link" text="more-controls-link" voice="" varImage="" left="875" donate="false" top="702" width="142" height="56" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/square-blank.png" altButtonFile="theater-buttons/square-blank-pressed.png" linkActivity="[bg]hometheater^kodi-controls-secondary" repeat="0" interval="0.0" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="buttonicons/theater 100 x 100/more-icon.png" touchTip="False" watchHTTPDirect="False" index="11"><code/></button><button name="pause" type="http" text="pause" voice="" varImage="" left="720" donate="false" top="784" width="50" height="24" textPosition="on" textSize="medium" textColor="" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="kodi-proxy" remotePort="POST" icon="" touchTip="False" watchHTTPDirect="False" index="12"><code>jsonrpc[?]{"jsonrpc":"2.0","method":"Input.ExecuteAction","params":{"action":"pause"},"id":1}</code></button><button name="play" type="http" text="play" voice="" varImage="" left="655" donate="false" top="783" width="52" height="27" textPosition="on" textSize="medium" textColor="" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="kodi-proxy" remotePort="POST" icon="" touchTip="False" watchHTTPDirect="False" index="13"><code>jsonrpc[?]{"jsonrpc":"2.0","method":"Input.ExecuteAction","params":{"action":"play"},"id":1}</code></button><button name="subtitle-check" type="http#&lt;" text="subtitle-check" voice="" varImage="" left="157" donate="false" top="792" width="103" height="40" textPosition="on" textSize="medium" textColor="Black" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="0" interval="0.45" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="kodi-proxy" remotePort="POST" icon="" touchTip="False" watchHTTPDirect="False" index="14"><code>jsonrpc[?]{"jsonrpc":"2.0","method":"Player.GetProperties","params":{"playerid":1,"properties":["subtitleenabled"]},"id":1}</code><script>[quiet]&#13;
if(_feedback &amp;amp;&amp;amp; _feedback.startsWith('{')) {&#13;
data = JSON.parse(_feedback);&#13;
&#13;
curSubtitles = data.result.subtitleenabled;&#13;
&#13;
if (curSubtitles == false) {&#13;
  _local.nextSubtitlesValue = 'on';&#13;
  _setImage('subtitles', 'theater-buttons/enable-subtitles-noselected.png');&#13;
} else if (curSubtitles == true) {&#13;
    _local.nextSubtitlesValue = 'off';&#13;
    _setImage('subtitles', 'theater-buttons/enable-subtitles-selected.png');&#13;
}&#13;
}</script></button><button name="playOrPause" type="http" text="playOrPause" voice="" varImage="" left="475" donate="false" top="468" width="115" height="115" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/round-blank.png" altButtonFile="theater-buttons/round-blank-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="kodi-proxy" remotePort="POST" icon="" touchTip="False" watchHTTPDirect="False" index="15"><code>jsonrpc[?]{"jsonrpc":"2.0","method":"Input.ExecuteAction","params":{"action":"%nextCommand%"},"id":1}</code></button><button name="player-speed-check" type="http#&lt;" text="player-speed-check" voice="" varImage="" left="502" donate="false" top="790" width="150" height="34" textPosition="on" textSize="medium" textColor="" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="0" interval="0.3" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="kodi-proxy" remotePort="POST" icon="" touchTip="False" watchHTTPDirect="False" index="16"><code>jsonrpc[?]{"jsonrpc":"2.0","method":"Player.GetProperties","params":{"playerid":1,"properties":["speed","percentage","time","totaltime"]},"id":1}</code><script>[quiet]&#13;
if(_feedback &amp;amp;&amp;amp; _feedback.startsWith('{')) {&#13;
data = JSON.parse(_feedback);&#13;
&#13;
playerSpeed = data.result.speed;&#13;
_local.playerTime = data.result.time.hours + ':' + data.result.time.minutes;&#13;
_local.playerTotalTime = data.result.totaltime.hours + ':' + data.result.totaltime.minutes;&#13;
_local.playerPercentage = Math.round(data.result.percentage);&#13;
&#13;
millisecTime = data.result.time.hours * 1000 * 60 *60 + data.result.time.minutes * 1000 * 60 + data.result.time.seconds * 1000;&#13;
millisecTotal = data.result.totaltime.hours * 1000 * 60 *60 + data.result.totaltime.minutes * 1000 * 60 + data.result.totaltime.seconds * 1000;&#13;
millisecTimeLeft = millisecTotal - millisecTime;&#13;
&#13;
//_local.debugText = _local.debugText +'\n' &#13;
// + 'got times:' +millisecTime + ',' + millisecTotal +',' + millisecTimeLeft;&#13;
//_setText('debug', _local.debugText);&#13;
&#13;
&#13;
today = new Date();&#13;
_local.endTime = 'n/a';&#13;
if( millisecTotal &gt; 0) {&#13;
    milliNow = today.getHours() * 1000 * 60 * 60 + today.getMinutes() * 1000 * 60 + today.getSeconds() * 1000;&#13;
    milliEndTime = milliNow + millisecTimeLeft;&#13;
    endHH = Math.floor(milliEndTime / 1000 / 60 / 60);&#13;
    msec = milliEndTime - endHH * 1000 * 60 * 60;&#13;
    endMM = Math.floor(msec / 1000 / 60);&#13;
    &#13;
    //_local.debugText = _local.debugText +'\n' + 'got time calcultions:' +milliNow &#13;
// + ',' + milliEndTime +',' + endHH +',' + msec +',' + endMM;&#13;
    //_setText('debug', _local.debugText);&#13;
&#13;
    _local.endTime = convert24HourTime(endHH, endMM);&#13;
    &#13;
&#13;
    &#13;
}&#13;
&#13;
endHH = Math.floor(millisecTimeLeft /1000/60/60);&#13;
msec = millisecTimeLeft - endHH * 1000 * 60 * 60;&#13;
endMM = Math.floor(msec /1000/ 60);&#13;
_local.timeLeft = endHH + ':' + endMM;&#13;
&#13;
_local.currentTime = convert24HourTime(today.getHours(),today.getMinutes());&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
//_local.debugText = _local.debugText +'\n' + 'got player speed ' + playerSpeed;&#13;
//_local.debugText = _local.debugText +'\n' + 'got player percentage' &#13;
// + _local.playerPercentage;&#13;
&#13;
//_setText('debug', _local.debugText);&#13;
&#13;
if (playerSpeed &gt; 0 ) {&#13;
    _local.nextCommand='pause';&#13;
    _setIcon('playOrPause', 'buttonicons/theater 70 x 70/pause.png');&#13;
} else if (playerSpeed == 0) {&#13;
    _local.nextCommand='play';&#13;
    _setIcon('playOrPause', 'buttonicons/theater 70 x 70/play.png');&#13;
}&#13;
&#13;
function convert24HourTime(hours, min) {&#13;
    suffix = suffix = hours &gt;= 12 ? "PM":"AM";&#13;
    hours = ((hours + 11) % 12 + 1);&#13;
    min =  min &lt; 10 ? "0" + min : min;&#13;
&#13;
    return hours +':' + min +' ' + suffix;&#13;
}&#13;
}</script><postscript>return '[#]progress-bar';</postscript></button><button name="currentMovieTitle" type="label" text="Currently Playing:&#10;%currentMovieTitle%" voice="" varImage="" left="208" donate="false" top="127" width="181" height="57" textPosition="on" textSize="medium" textColor="LightGray" delay="no" buttonPack="Clear" buttonFile="" altButtonFile="" linkActivity="" repeat="0" interval="0.0" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="17"><code>Currently Playing:\n%currentMovieTitle%</code></button><button name="currently-playing-check" type="http#&lt;" text="currently-playing-check" voice="" varImage="" left="377" donate="false" top="792" width="114" height="33" textPosition="on" textSize="medium" textColor="" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="0" interval="1.0" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="kodi-proxy" remotePort="POST" icon="" touchTip="False" watchHTTPDirect="False" index="18"><code>jsonrpc[?]{"jsonrpc":"2.0","method":"Player.GetItem","params":{"playerid":1,"properties":["art","title"]},"id":1}</code><script>[quiet]&#13;
&#13;
if(_feedback &amp;amp;&amp;amp; _feedback.startsWith('{')) {&#13;
data = JSON.parse(_feedback);&#13;
if(data.result.item &amp;amp;&amp;amp; data.result.item.art) {&#13;
   poster = data.result.item.art.poster;&#13;
   title = data.result.item.title;&#13;
}&#13;
if (poster) {&#13;
_global.currentMoviePoster = 'http://media.diodati.lan:18081/image/' + encodeURIComponent(poster);&#13;
_global.currentMovieTitle = title;&#13;
} else {&#13;
_global.currentMoviePoster = 'images/theater-buttons/postericon.png';&#13;
//_global.currentMoviePoster = 'https://picsum.photos/150/220';&#13;
//_global.currentMoviePoster = '';&#13;
_global.currentMovieTitle = "No Movie Playing.";&#13;
}&#13;
&#13;
&#13;
return '[#]kodi^movie_image';&#13;
&#13;
} else {&#13;
//log("got error " + _feedback);&#13;
&#13;
&#13;
}</script><prescript>//dont null the poster attribute since once in a while we get a server error and it will&#13;
// just keep using the previous value</prescript><postscript>checkServiceConnection('192.168.1.10', 80);</postscript></button><button name="check-timer" type="script#" text="check-timer" voice="" varImage="" left="270" donate="false" top="854" width="93" height="28" textPosition="ondisabled" textSize="medium" textColor="" delay="no" buttonPack="" buttonFile="" altButtonFile="" linkActivity="" repeat="0" interval="0.3" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="" touchTip="False" watchHTTPDirect="False" index="19"><code/><script>//return '[#]subtitle-check[#]currently playing[#]player-speed-check[#]{&gt;}volume-check';&#13;
return '[#]{&gt;}subtitle-check[#]{&gt;}currently playing[#]{&gt;}player-speed-check[#]{&gt;}volume-check';&#13;
&#13;
&#13;
&#13;
//if (_connectable('192.168.1.11', 18080) ) {&#13;
  // trigger subtitle check on load too.&#13;
//  return '[#]subtitle-check[#]currently playing[#]player-speed-check';&#13;
//} else {&#13;
//  _local.message = 'Problem connecting to kodi please check device';&#13;
//  _setTop('_macroMessage', 100);&#13;
//  _setLeft('_macroMessage', 100);&#13;
  //_setWidth('_macroMessage', 800);&#13;
  //_setHeight('_macroMessage', 500);&#13;
//}</script></button><button name="movie_image" type="web" text="[&lt;html&gt;]" voice="" varImage="" left="206" donate="false" top="188" width="182" height="237" textPosition="on" textSize="medium" textColor="" delay="norefresh" buttonPack="" buttonFile="" altButtonFile="theater-buttons/square-blank-pressed.png" linkActivity="background" repeat="1" interval="0.0" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="" remotePort="" icon="buttonicons/Black 20x20/source.png" touchTip="False" watchHTTPDirect="False" index="21"><code/><htmlText/></button><button name="step back" type="http" text="step back" voice="" varImage="" left="291" donate="false" top="466" width="90" height="90" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/round-blank.png" altButtonFile="theater-buttons/round-blank-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="kodi-proxy" remotePort="POST" icon="buttonicons/theater 50 x 50/skip-rewind.png" touchTip="False" watchHTTPDirect="False" index="33"><code>jsonrpc[?]{"jsonrpc":"2.0","method":"Input.ExecuteAction","params":{"action":"stepback"},"id":1}</code></button><button name="rewind" type="http" text="rewind" voice="" varImage="" left="383" donate="false" top="466" width="90" height="90" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/round-blank.png" altButtonFile="theater-buttons/round-blank-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="kodi-proxy" remotePort="POST" icon="buttonicons/theater 50 x 50/rewind.png" touchTip="False" watchHTTPDirect="False" index="34"><code>jsonrpc[?]{"jsonrpc":"2.0","method":"Player.SetSpeed","params":{"playerid":1,"speed":"decrement"},"id":1}</code></button><button name="step forward" type="http" text="step forward" voice="" varImage="" left="681" donate="false" top="466" width="90" height="90" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/round-blank.png" altButtonFile="theater-buttons/round-blank-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="kodi-proxy" remotePort="POST" icon="buttonicons/theater 50 x 50/skipforward.png" touchTip="False" watchHTTPDirect="False" index="35"><code>jsonrpc[?]{"jsonrpc":"2.0","method":"Input.ExecuteAction","params":{"action":"stepforward"},"id":1}</code></button><button name="fastforward" type="http" text="fastforward" voice="" varImage="" left="590" donate="false" top="466" width="90" height="90" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/round-blank.png" altButtonFile="theater-buttons/round-blank-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="kodi-proxy" remotePort="POST" icon="buttonicons/theater 50 x 50/fastforward.png" touchTip="False" watchHTTPDirect="False" index="36"><code>jsonrpc[?]{"jsonrpc":"2.0","method":"Player.SetSpeed","params":{"playerid":1,"speed":"increment"},"id":1}</code></button><button name="info" type="http" text="info" voice="" varImage="" left="875" donate="false" top="235" width="132" height="133" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/square-blank.png" altButtonFile="theater-buttons/square-blank-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="kodi-proxy" remotePort="POST" icon="buttonicons/theater 100 x 100/info-icon.png" touchTip="False" watchHTTPDirect="False" index="37"><code>jsonrpc[?]{"jsonrpc":"2.0","method":"Input.Info","id":1}</code></button><button name="stop" type="http" text="stop" voice="" varImage="" left="811" donate="false" top="445" width="115" height="115" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="theater-buttons" buttonFile="theater-buttons/round-blank.png" altButtonFile="theater-buttons/round-blank-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="kodi-proxy" remotePort="POST" icon="buttonicons/theater 50 x 50/stop.png" touchTip="False" watchHTTPDirect="False" index="38"><code>jsonrpc[?]{"jsonrpc":"2.0","method":"Player.Stop","params":{"playerid":1},"id":1}</code></button><button name="subtitles" type="http" text="subtitles" voice="" varImage="" left="15" donate="false" top="667" width="147" height="81" textPosition="off" textSize="medium" textColor="" delay="no" buttonPack="brushed-blank-buttons" buttonFile="brushed-blank-buttons/source-blank-default.png" altButtonFile="brushed-blank-buttons/source-blank-pressed.png" linkActivity="" repeat="0" interval="0.1" rotation="0.0" autoexec="False" autoappear="False" autoexit="False" autoresume="False" remoteHost="kodi-proxy" remotePort="POST" icon="buttonicons/theater 100 x 100/subtitles-icon.png" touchTip="False" watchHTTPDirect="False" index="39"><code>jsonrpc[?]{"jsonrpc":"2.0","method":"Player.SetSubtitle","params":{"playerid":1,"subtitle":"%nextSubtitlesValue%"},"id":1}</code><prescript>_local.debugText = _local.debugText +"\n" + "before submit nextSubtitleValue is " + _local.nextSubtitlesValue;&#13;
_setText('debug', _local.debugText);</prescript><postscript>return '[#]subtitle-check';</postscript></button></buttons></device><device name="projector screen"><buttons/></device><device name="sonyprojector"><buttons/></device></activity></activities></touchControl>
